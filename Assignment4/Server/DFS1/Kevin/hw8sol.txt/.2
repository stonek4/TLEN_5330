sing r_idx on imdbratings  (cost=0.28..180.67 rows=4708 width=8)
                         Index Cond: (rating IS NOT NULL)
   ->  Seq Scan on movies m  (cost=0.00..117.08 rows=4708 width=20)
   ->  Hash  (cost=9.33..9.33 rows=60 width=12)
         ->  Index Scan using r_idx on imdbratings r  (cost=0.28..9.33 rows=60 width=12)
               Index Cond: (rating = $1)

QUESTION 3 QUERY PLAN: (no indexes but rewritten)

HashAggregate  (cost=28893.87..28988.03 rows=4708 width=24)
   Group Key: m.id
   Filter: (avg(t.rating) = $0)
   InitPlan 1 (returns $0)
     ->  Limit  (cost=14058.17..14058.18 rows=1 width=8)
           ->  Sort  (cost=14058.17..14069.94 rows=4708 width=8)
                 Sort Key: (avg(t_1.rating))
                 ->  HashAggregate  (cost=13975.78..14034.63 rows=4708 width=8)
                       Group Key: m_1.id
                       ->  Hash Join  (cost=175.93..12255.95 rows=343966 width=8)
                             Hash Cond: (t_1.movieid = m_1.id)
                             ->  Seq Scan on twitterratings t_1  (cost=0.00..5630.66 rows=343966 width=8)
                             ->  Hash  (cost=117.08..117.08 rows=4708 width=4)
                                   ->  Seq Scan on movies m_1  (cost=0.00..117.08 rows=4708 width=4)
   ->  Hash Join  (cost=175.93..12255.95 rows=343966 width=24)
         Hash Cond: (t.movieid = m.id)
         -> 